{% extends 'base.html' %}

{% block content %}

    {% if messages %}
        <div>
            {% for message in messages %}
                <p class="message">{{ message }}</p>
            {% endfor %}
        </div>
    {% endif %}

    {% if user.profile.image.url %}
        <img class="img-circle" src="{{ user.profile.image.url }}">
    {% else %}
        <img class="img-circle" src="../media/default_profile_img.jpg">
    {% endif %}
    <h1>Hello {{ user.username | capfirst }}</h1>
    <p>You will find all your activity in the below tabs.</p>
    <hr>
    <div>
        <ul class="nav nav-tabs" role="tablist">
            <li role="presentation" class="active"><a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">Profile</a></li>
            <li role="presentation"><a href="#issues" aria-controls="issues" role="tab" data-toggle="tab">Issues</a></li>
            <li role="presentation"><a href="#features" aria-controls="features" role="tab" data-toggle="tab">Features</a></li>
            <li role="presentation"><a href="#comments" aria-controls="comments" role="tab" data-toggle="tab">Comments</a></li>
            <li role="presentation"><a href="#votes" aria-controls="votes" role="tab" data-toggle="tab">Votes</a></li>
        </ul>
        <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="profile">
                <p>Your personal data. Upload or change image or other details</p>
                <p>{{ user }}</p>
            </div>
            <div role="tabpanel" class="tab-pane" id="issues">
                <h2>Issues created by you:</h2>
                {% for issue in issues %}
                    <a href="{% url 'issue_detail' issue.id %}">
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <p class="type-roboto"><strong>{{ issue.title }}</strong> | <small>Published on: {{ issue.published_date | date:'F d, Y @ P' }}</small></p>
                                {% if issue.category == 'in progress' %}
                                    <span class="label label-warning">{{ issue.category }}</span>
                                {% elif issue.category == 'done' %}
                                    <span class="label label-success">{{ issue.category }}</span>
                                {% else %}
                                    <span class="label label-default">{{ issue.category }}</span>
                                {% endif %}
                                <span class="label label-info text-right">{{issue.user_votes}} <small>votes</small></span>
                                <p><small>{{ issue.description | capfirst | truncatewords:10 }}</small></p>
                            </div>  
                        </div>
                    </a>
                {% endfor %}
            </div>
            <div role="tabpanel" class="tab-pane" id="features">
                <h2>Features created by you:</h2>
                {% for feature in features %}
                    <a href="{% url 'feature_detail' feature.id %}">
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <p class="type-roboto"><strong>{{ feature.title }}</strong> | <small>Published on: {{ feature.published_date | date:'F d, Y @ P' }}</small></p>
                                {% if feature.category == 'in progress' %}
                                    <span class="label label-warning">{{ feature.category }}</span>
                                {% elif feature.category == 'done' %}
                                    <span class="label label-success">{{ feature.category }}</span>
                                {% else %}
                                    <span class="label label-default">{{ feature.category }}</span>
                                {% endif %}
                                <span class="label label-info text-right">{{feature.user_votes}} <small>votes</small></span>
                                <p><small>{{ feature.description | capfirst | truncatewords:10 }}</small></p>
                            </div>  
                        </div>
                    </a>
                {% endfor %}
            </div>
            <div role="tabpanel" class="tab-pane dashboard-panel" id="comments">
                <h2>Blog comments:</h2>
                {% for blog in blog_comments %}   
                    <a href="{% url 'post_detail' blog.post.id %}">
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <p class="type-roboto"><strong>{{ blog.post }}</strong> | <small>Published on: {{ blog.published_date | date:'F d, Y @ P' }}</small></p>
                                <p><small>{{ blog | capfirst | truncatewords:10 }}</small></p>
                            </div>  
                        </div>
                    </a>
                {% endfor %}
                <h2>Issues comments:</h2>
                {% for bug in issues_comments %}   
                    <a href="{% url 'issue_detail' bug.issue.id %}">
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <p class="type-roboto"><strong>{{ bug.issue }}</strong> | <small>Published on: {{ bug.published_date | date:'F d, Y @ P' }}</small></p>
                                <p><small>{{ bug | capfirst | truncatewords:10 }}</small></p>
                            </div>  
                        </div>
                    </a>
                {% endfor %}
                <h2>Features comments:</h2>
                {% for feature in features_comments %}   
                    <a href="{% url 'feature_detail' feature.feature.id %}">
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <p class="type-roboto"><strong>{{ feature.feature }}</strong> | <small>Published on: {{ feature.published_date | date:'F d, Y @ P' }}</small></p>
                                <p><small>{{ feature | capfirst | truncatewords:10 }}</small></p>
                            </div>  
                        </div>
                    </a>
                {% endfor %}
            </div>
            <div role="tabpanel" class="tab-pane" id="votes">
                <h2>Votes added by you:</h2>
                <p></p>
            </div>
        </div>
    </div>

{% endblock  %}

{% comment %} {% block script %} {% endcomment %}

{% comment %} $('#myTabs a').click(function (e) {
    e.preventDefault()
    $(this).tab('show')
}) {% endcomment %}

{% comment %} {% endblock %} {% endcomment %}